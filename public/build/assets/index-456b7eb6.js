import{r as a,l as S,w as I,d as N,o as d,e,x as g,a5 as $,c as r,k as y,F as v,a6 as A,a as D,b as L,t as l}from"./app-a0ce6157.js";import{A as O}from"./LayoutSupervisor-a144943f.js";import{X as h}from"./xlsx-836c9b7f.js";import{a as P}from"./TopMenu-ce49d3e8.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./ResponsiveNavLink-ab7e1a8e.js";const V={class:"p-4",style:{background:"white"}},j={class:"flex justify-between mb-2"},z=e("label",{for:"programa"},"Programa de Estudio: ",-1),F=["value"],M=e("label",{for:"busqueda"},"Buscar por Nombre o DNI: ",-1),R={style:{"border-radius":"4px",width:"100%",overflow:"hidden"}},U=e("thead",{style:{height:"30px",color:"white","background-color":"var(--primary-color)",padding:"0px 10px"}},[e("tr",{style:{"font-size":".9rem"}},[e("th",{style:{border:"1px solid #d9d9d9"}},"DNI"),e("th",{style:{border:"1px solid #d9d9d9"}},"APELLIDOS Y NOMBRES"),e("th",{style:{border:"1px solid #d9d9d9"}},"UBICACION"),e("th",{style:{border:"1px solid #d9d9d9"}},"PROGRAMA DE ESTUDIO"),e("th",{style:{border:"1px solid #d9d9d9"}},"INGRESO"),e("th",{style:{border:"1px solid #d9d9d9"}},"C1"),e("th",{style:{border:"1px solid #d9d9d9"}},"C2"),e("th",{style:{border:"1px solid #d9d9d9"}},"C3"),e("th",{style:{border:"1px solid #d9d9d9"}},"C4"),e("th",{style:{border:"1px solid #d9d9d9"}},"C5"),e("th",{style:{border:"1px solid #d9d9d9"}},"C6"),e("th",{style:{border:"1px solid #d9d9d9"}},"C7"),e("th",{style:{border:"1px solid #d9d9d9"}},"C8"),e("th",{style:{border:"1px solid #d9d9d9"}},"C9"),e("th",{style:{border:"1px solid #d9d9d9"}},"C10"),e("th",{style:{border:"1px solid #d9d9d9"}},"C11")])],-1),q={style:{border:"1px solid #d9d9d9","font-weight":".8rem","text-align":"center"}},X={class:"pl-1 pr-1"},G={style:{border:"1px solid #d9d9d9","font-weight":".7rem"}},T={class:"pl-1 pr-1"},Y={style:{border:"1px solid #d9d9d9","font-weight":".8rem","text-align":"center"}},H={class:"pl-1 pr-1"},J={style:{border:"1px solid #d9d9d9","font-weight":".8rem","text-align":"center"}},K={class:"pl-1 pr-1"},Q={style:{border:"1px solid #d9d9d9","font-weight":".8rem","text-align":"center"}},W={class:"pl-1 pr-1"},Z={key:0,style:{"text-align":"center"}},ee={key:0},te={key:1},se=e("span",{style:{"font-size":".9rem"}},null,-1),oe=[se],de={key:1,style:{"text-align":"center"}},ce={__name:"index",setup(re){function i(s,o){for(var t=0;t<s.length;t++)if(s[t].competencia===o)return t;return null}const m=a(1),_=a([]),x=a([]),u=a([]),p=a(""),c=a(""),f=a([]),w=async()=>{let s=await N.get("notasperf-supervisor?page="+m.value,{term:""});_.value=s.data.datos,C(),u.value.length>0&&(p.value=u.value[0],b())},C=()=>{const s=new Set;_.value.forEach(o=>{s.add(o.programa)}),u.value=Array.from(s)},b=()=>{x.value=_.value.filter(s=>s.programa===p.value&&(s.dni.includes(c.value)||`${s.paterno} ${s.materno} ${s.nombre}`.toLowerCase().includes(c.value.toLowerCase()))),k()},k=()=>{f.value=x.value.map(s=>{const o={dni:s.dni,programa:s.programa,semestre:s.semestre,filial:s.filial,nombreCompleto:`${s.paterno} ${s.materno},  ${s.nombre}`};for(let t=1;t<=11;t++){const n=i(s.notas,t);n!==null?o[`C${t}`]=s.notas[n].nota:o[`C${t}`]="--"}return o})},E=()=>{const s=h.utils.json_to_sheet(f.value),o=h.utils.book_new();h.utils.book_append_sheet(o,s,"Estudiantes"),h.writeFile(o,"estudiantes.xlsx")};return w(),(s,o)=>(d(),S(O,null,{default:I(()=>[e("div",V,[e("div",j,[e("div",null,[z,g(e("select",{id:"programa","onUpdate:modelValue":o[0]||(o[0]=t=>p.value=t),onChange:b},[(d(!0),r(v,null,y(u.value,t=>(d(),r("option",{key:t,value:t},l(t),9,F))),128))],544),[[$,p.value]])]),e("div",null,[M,g(e("input",{id:"busqueda","onUpdate:modelValue":o[1]||(o[1]=t=>c.value=t),onInput:b,type:"text",placeholder:"Buscar..."},null,544),[[A,c.value]])]),D(L(P),{label:"Exportar excel",onClick:E,size:"small",style:{height:"40px"}})]),e("table",R,[U,e("tbody",null,[(d(!0),r(v,null,y(x.value,t=>(d(),r("tr",{key:t.id,style:{"font-size":".9rem"}},[e("td",q,[e("div",X,l(t.dni),1)]),e("td",G,[e("div",T,l(t.paterno)+" "+l(t.materno)+", "+l(t.nombre),1)]),e("td",Y,[e("div",H,l(t.filial),1)]),e("td",J,[e("div",K,l(t.programa),1)]),e("td",Q,[e("div",W,l(t.semestre),1)]),(d(),r(v,null,y(11,(n,B)=>e("td",{key:B,style:{border:"1px solid #d9d9d9","min-width":"40px"}},[i(t.notas,n)!==null?(d(),r("div",Z,[t.notas[i(t.notas,n)]?(d(),r("div",ee,l(t.notas[i(t.notas,n)].nota),1)):(d(),r("div",te,oe))])):(d(),r("div",de," - - "))])),64))]))),128))])])])]),_:1}))}};export{ce as default};
