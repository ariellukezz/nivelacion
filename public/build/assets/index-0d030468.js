import{r as n,o as U,j,w as c,a as A,e as O,b as l,d as r,Z as G,f as s,t as i,g as h,a9 as H,p as X,q}from"./app-f994730f.js";import{A as W}from"./LayoutSuperadmi-4dc1cd2d.js";import{s as Y}from"./datatable.esm-f7182f59.js";import{s as b}from"./column.esm-434bfdc1.js";import{a as Z,s as E}from"./index.esm-0e4f3215.js";import{s as V}from"./dropdown.esm-99078355.js";import{_ as z}from"./_plugin-vue_export-helper-c27b6911.js";import"./TopMenu-f2fc4239.js";import"./ResponsiveNavLink-eb2fad28.js";import"./inputnumber.esm-8769ed9c.js";const L=w=>(X("data-v-11de1f6a"),w=w(),q(),w),J={class:"p-4 bg-white rounded-lg shadow"},K=L(()=>s("h2",{class:"text-xl font-semibold mb-4"},"Docentes por Competencias",-1)),Q={class:"mb-6 grid grid-cols-1 md:grid-cols-4 gap-4"},ee={class:"p-input-icon-left"},oe=L(()=>s("i",{class:"pi pi-search"},null,-1)),ae={class:"mb-4 flex items-center gap-3"},te={class:"font-medium"},se={class:"text-sm text-gray-500"},le={class:"text-sm text-gray-500"},re={class:"font-semibold"},ne={class:"text-gray-400"},ie=L(()=>s("div",{class:"text-center py-8 text-gray-500"},[s("i",{class:"pi pi-info-circle mr-2"}),h(" No se encontraron resultados ")],-1)),ce=L(()=>s("div",{class:"text-center py-8"},[s("i",{class:"pi pi-spinner pi-spin mr-2"}),h(" Cargando datos... ")],-1)),pe={__name:"index",setup(w){const y=n([]),u=n([]),m=n(""),_=n(null),f=n(null),g=n(null),$=n([]),k=n([]),D=n([]),P=n(!0),M=async()=>{try{P.value=!0;const a=await A.get("docentes-competencias-data");a.data.success?(y.value=a.data.data.docentes,u.value=a.data.data.docentes,$.value=a.data.data.filtros.programas,k.value=a.data.data.filtros.periodos,D.value=a.data.data.filtros.competencias):console.error("Error en la respuesta:",a.data.message)}catch(a){console.error("Error al obtener docentes:",a)}finally{P.value=!1}},x=()=>{let a=y.value;if(m.value){const o=m.value.toLowerCase();a=a.filter(e=>e.paterno&&e.paterno.toLowerCase().includes(o)||e.materno&&e.materno.toLowerCase().includes(o)||e.nombres&&e.nombres.toLowerCase().includes(o)||e.email&&e.email.toLowerCase().includes(o)||e.telefono&&e.telefono.toLowerCase().includes(o)||e.competencia_nombre&&e.competencia_nombre.toLowerCase().includes(o)||e.curso_nombre&&e.curso_nombre.toLowerCase().includes(o)||e.programa&&e.programa.toLowerCase().includes(o)||e.periodo_nombre&&e.periodo_nombre.toLowerCase().includes(o))}_.value&&(a=a.filter(o=>o.programa_id===_.value)),f.value&&(a=a.filter(o=>o.id_periodo===f.value)),g.value&&(a=a.filter(o=>o.id_competencia===g.value)),u.value=a},F=()=>{m.value="",_.value=null,f.value=null,g.value=null,u.value=y.value};U(M);let p=null;const C=n(!1),I=async()=>{try{C.value=!0,p||(p=await H(()=>import("./xlsx-0302e83b.js").then(t=>t.x),["assets/xlsx-0302e83b.js","assets/app-f994730f.js","assets/app-dd726735.css"]));const a=u.value||[];if(!a.length){console.warn("No hay datos para exportar"),C.value=!1;return}const o=a.map(t=>({Docente:`${t.paterno??""} ${t.materno??""}, ${t.nombres??""}`.trim(),Email:t.email??"",TelÃ©fono:t.telefono??"",Competencia:`${t.competencia_cod??""}${t.competencia_cod?" - ":""}${t.competencia_nombre??""}`.trim(),Curso:t.curso_nombre??"",Grupo:t.grupo??"",Programa:t.programa??"",Periodo:t.periodo_nombre??""})),e=p.utils.book_new(),S=p.utils.json_to_sheet(o,{skipHeader:!1}),N=Object.keys(o[0]).map(t=>{const R=Math.max(t.length,...o.map(B=>String(B[t]??"").length));return{wch:Math.min(Math.max(R+2,12),60)}});S["!cols"]=N,p.utils.book_append_sheet(e,S,"Docentes");const d=new Date,v=t=>String(t).padStart(2,"0"),T=`${d.getFullYear()}-${v(d.getMonth()+1)}-${v(d.getDate())}_${v(d.getHours())}${v(d.getMinutes())}${v(d.getSeconds())}`;p.writeFile(e,`docentes_competencias_${T}.xlsx`)}catch(a){console.error(a)}finally{C.value=!1}};return(a,o)=>(O(),j(W,null,{default:c(()=>[l(r(G),{title:"Docentes por Competencias"}),s("div",J,[K,s("div",Q,[s("span",ee,[oe,l(r(Z),{modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=e=>m.value=e),placeholder:"Buscar docentes...",class:"w-full",onInput:x},null,8,["modelValue"])]),l(r(V),{modelValue:_.value,"onUpdate:modelValue":o[1]||(o[1]=e=>_.value=e),options:$.value,optionLabel:"programa",optionValue:"programa_id",placeholder:"Seleccionar Programa",class:"w-full",onChange:x,showClear:""},null,8,["modelValue","options"]),l(r(V),{modelValue:f.value,"onUpdate:modelValue":o[2]||(o[2]=e=>f.value=e),options:k.value,optionLabel:"periodo_nombre",optionValue:"id_periodo",placeholder:"Seleccionar Periodo",class:"w-full",onChange:x,showClear:""},null,8,["modelValue","options"]),l(r(V),{modelValue:g.value,"onUpdate:modelValue":o[3]||(o[3]=e=>g.value=e),options:D.value,optionLabel:"competencia_nombre",optionValue:"id_competencia",placeholder:"Seleccionar Competencia",class:"w-full",onChange:x,showClear:""},null,8,["modelValue","options"])]),s("div",ae,[l(r(E),{label:"Limpiar Filtros",icon:"pi pi-times",class:"p-button-outlined p-button-sm",onClick:F}),l(r(E),{icon:"pi pi-file-excel",label:"Exportar Excel",severity:"success",loading:C.value,onClick:I},null,8,["loading"])]),l(r(Y),{value:u.value,loading:P.value,stripedRows:"",paginator:"",rows:10,rowsPerPageOptions:[10,25,50],class:"p-datatable-sm",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} docentes",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},{empty:c(()=>[ie]),loading:c(()=>[ce]),default:c(()=>[l(r(b),{field:"docente",header:"Docente",sortable:""},{body:c(({data:e})=>[s("div",te,i(e.paterno)+" "+i(e.materno)+", "+i(e.nombres),1),s("div",se,i(e.email),1),s("div",le,i(e.telefono),1)]),_:1}),l(r(b),{field:"competencia",header:"Competencia",sortable:""},{body:c(({data:e})=>[s("span",re,i(e.competencia_cod),1),h(" - "+i(e.competencia_nombre),1)]),_:1}),l(r(b),{field:"curso",header:"Curso",sortable:""},{body:c(({data:e})=>[h(i(e.curso_nombre)+" ",1),s("span",ne,"(Grupo "+i(e.grupo)+")",1)]),_:1}),l(r(b),{field:"programa",header:"Programa",sortable:""}),l(r(b),{field:"periodo",header:"Periodo",sortable:""},{body:c(({data:e})=>[h(i(e.periodo_nombre),1)]),_:1})]),_:1},8,["value","loading"])])]),_:1}))}},Ce=z(pe,[["__scopeId","data-v-11de1f6a"]]);export{Ce as default};
