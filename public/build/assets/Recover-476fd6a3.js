import{K as E,B as V,r as _,k as C,c as h,a,w as u,b as e,i as g,h as p,e as o,o as r,t as i,g as D,f as v,I as T}from"./app-9957fcc0.js";import{s as x}from"./card.esm-16c78c88.js";import{a as U,s as w}from"./index.esm-b6b36824.js";import{s as $}from"./radiobutton.esm-3ea7ad20.js";import{s as B}from"./message.esm-2e473cf2.js";import"./basecomponent.esm-a1de724f.js";const j={class:"max-w-xl mx-auto p-6"},M=o("h1",{class:"text-xl font-bold mb-4"},"Recuperar contraseña",-1),O=["onSubmit"],R={class:"mb-3"},A=o("label",{class:"block mb-1"},"Tipo de usuario",-1),F={class:"flex gap-4"},K={class:"flex items-center gap-2"},q=o("label",{for:"alumno"},"Alumno",-1),z={class:"flex items-center gap-2"},G=o("label",{for:"docente"},"Docente",-1),H={key:0,class:"p-error"},J={class:"mb-3"},L={class:"block mb-1"},P={key:0,class:"p-error"},Q={class:"mb-2"},W={class:"flex flex-col gap-2"},X={class:"mt-4"},ae={__name:"Recover",setup(Y){const I=E(),l=V({tipo:"",identificador:""}),m=l.errors,f=_(!1),b=_(""),k=_(""),c=_(null),N=async()=>{c.value=null,f.value=!1,await l.post("/recover/lookup",{onSuccess:()=>{const t=I.props.flash||{};t.found&&(f.value=!0,b.value=t.email_masked,k.value=t.lookup_token)}})},d=V({lookup_token:"",modo:"link"});C(k,t=>d.lookup_token=t);const S=async t=>{c.value=null,d.modo=t,await d.post("/recover/send",{preserveScroll:!0,onSuccess:()=>{f.value=!1,b.value="",k.value=""},onError:()=>{const s=d.errors;s&&Object.keys(s).length&&(c.value=Object.values(s)[0])}})};return(t,s)=>{var y;return r(),h("div",j,[M,a(e(x),{class:"mb-4"},{content:u(()=>[o("form",{onSubmit:D(N,["prevent"])},[o("div",R,[A,o("div",F,[o("div",K,[a(e($),{inputId:"alumno",value:"alumno",modelValue:e(l).tipo,"onUpdate:modelValue":s[0]||(s[0]=n=>e(l).tipo=n)},null,8,["modelValue"]),q]),o("div",z,[a(e($),{inputId:"docente",value:"docente",modelValue:e(l).tipo,"onUpdate:modelValue":s[1]||(s[1]=n=>e(l).tipo=n)},null,8,["modelValue"]),G])]),e(m).tipo?(r(),h("small",H,i(e(m).tipo),1)):p("",!0)]),o("div",J,[o("label",L,i(e(l).tipo==="docente"?"DNI del docente":"Código del alumno"),1),a(e(U),{modelValue:e(l).identificador,"onUpdate:modelValue":s[2]||(s[2]=n=>e(l).identificador=n),class:"w-full",placeholder:"Ingrese DNI o código"},null,8,["modelValue"]),e(m).identificador?(r(),h("small",P,i(e(m).identificador),1)):p("",!0)]),a(e(w),{type:"submit",label:"Buscar",loading:e(l).processing},null,8,["loading"])],40,O)]),_:1}),f.value?(r(),g(e(x),{key:0,class:"mb-3"},{content:u(()=>[o("p",Q,[v("Encontramos un usuario con correo: "),o("strong",null,i(b.value),1)]),o("div",W,[a(e(w),{label:"Enviar contraseña temporal",severity:"secondary",outlined:"",onClick:s[3]||(s[3]=n=>S("password")),loading:e(d).processing},null,8,["loading"])])]),_:1})):p("",!0),(y=t.$page.props.flash)!=null&&y.status?(r(),g(e(B),{key:1,severity:"success",closable:!1,class:"mb-2"},{default:u(()=>[v(i(t.$page.props.flash.status),1)]),_:1})):p("",!0),c.value?(r(),g(e(B),{key:2,severity:"error",closable:!1,class:"mb-2"},{default:u(()=>[v(i(c.value),1)]),_:1})):p("",!0),o("div",X,[a(e(T),{href:"/login",class:"underline"},{default:u(()=>[v("Volver al inicio de sesión")]),_:1})])])}}};export{ae as default};
