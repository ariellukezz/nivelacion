import{A as O}from"./LayoutDocente-8ed15c6d.js";import{u as M,r as u,k as x,c as p,a as t,b as s,w as n,F as P,o as d,Z as T,e as l,f as $,t as m,h as v,n as A,i as j}from"./app-d65363e4.js";import{s as E,a as r,c as G}from"./column.esm-ac96d053.js";import{a as f,s as H,b as F}from"./TopMenu-ec2d5529.js";import{s as _}from"./tag.esm-24e92807.js";import{s as L}from"./divider.esm-67f98108.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./ResponsiveNavLink-8b8828d3.js";import"./basecomponent.esm-ddd39b64.js";const X={class:"flex",style:{background:"white","border-bottom":"1px solid #CDCDCD"}},Z={key:0,class:"flex justify-content-center",style:{"align-items":"center"}},q=l("i",{class:"pi pi-angle-right"},null,-1),J={style:{"max-width":"180px","white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden"}},K={class:"bg-white shadow-xs p-4",style:{height:"calc(100vh - 110px)","font-family":"Arial, Helvetica, sans-serif"}},Q={key:0},R={class:"flex",style:{"justify-content":"flex-end"}},W={class:"p-input-icon-left"},Y=l("i",{class:"pi pi-search"},null,-1),ee={class:"card"},se={class:"flex",style:{"justify-content":"center"}},te={key:0},oe={key:1},ae={class:"flex"},le={key:1},ie={class:"flex mb-3",style:{"justify-content":"space-between"}},ne={class:"flex align-items-center"},re={class:"p-input-icon-left"},de=l("i",{class:"pi pi-search"},null,-1),ce={class:"card p-fluid"},ue={class:"flex justify-center"},pe={key:0},me={key:1},ve={key:2},fe={class:"flex justify-center"},Ne={__name:"cursos",setup(ye){const I=M(),w=u(1),y=u(""),C=u([]),c=u(null),k=u(null),V=u([]),h=u(""),i=u({}),N=async()=>{let a=await axios.post("/docente/get-cursos?page="+w.value,{term:y.value});C.value=a.data.datos.data},b=async()=>{let a=await axios.post("/docente/get-alumnos-curso?page="+w.value,{term:h.value,curso:c.value.id});V.value=a.data.datos.data,i.value={}},U=()=>{c.value=null},z=async()=>{window.open("/docente/generar-pdf/"+c.value.id,"_blank")},B=a=>{const{data:o,field:e}=a;e==="nota"&&i.value[o.id]===void 0&&(i.value[o.id]=o.nota!==null?parseFloat(o.nota):null)},S=async()=>{if(Object.keys(i.value).length===0){g("warn","Advertencia","No hay cambios para guardar");return}try{const a=Object.entries(i.value).map(([o,e])=>axios.post("/docente/update-nota",{id_detallecurso:o,nota:e}));await Promise.all(a),g("success","Éxito","Notas guardadas correctamente"),b()}catch(a){g("error","Error","Ocurrió un error al guardar las notas"),console.error("Error al guardar notas:",a)}},g=(a,o,e)=>{I.add({severity:a,summary:o,detail:e,life:3e3})};return x(y,(a,o)=>{N()}),x(c,(a,o)=>{a&&b()}),x(h,(a,o)=>{b()}),u([{field:"codigo_est",header:"Código"},{field:"nombre_completo",header:"Nombre Completo",body:a=>`${a.nombres} ${a.paterno} ${a.materno}`},{field:"semestre",header:"Ingreso"}]),N(),(a,o)=>(d(),p(P,null,[t(s(T),{title:"Cursos"}),t(O,null,{default:n(()=>[l("div",X,[t(s(f),{severity:"secondary",style:{"font-size":"0.9rem"},text:"",onClick:U},{default:n(()=>[$(" Inicio ")]),_:1}),c.value!==null?(d(),p("div",Z,[q,t(s(f),{severity:"secondary",onClick:a.resEsuela,style:{"font-size":"0.9rem"},text:""},{default:n(()=>[l("div",J,[l("span",null,m(c.value.nombre),1)])]),_:1},8,["onClick"])])):v("",!0)]),l("div",K,[t(s(H)),c.value===null?(d(),p("div",Q,[l("div",null,[l("div",R,[l("span",W,[Y,t(s(F),{modelValue:y.value,"onUpdate:modelValue":o[0]||(o[0]=e=>y.value=e),style:{"padding-left":"40px",height:"40px"},placeholder:"Search"},null,8,["modelValue"])])])]),l("div",null,[l("div",ee,[t(s(E),{selectionMode:"single",selection:c.value,"onUpdate:selection":o[1]||(o[1]=e=>c.value=e),value:C.value,class:A("p-datatable-sm mt-4"),tableStyle:"min-width: 50rem",style:{"font-size":".9rem"}},{default:n(()=>[t(s(r),{field:"nombre",header:"Curso"}),t(s(r),{field:"grupo",header:"Grupo"}),t(s(r),{field:"escuela",header:"Escuela"}),t(s(r),{field:"programa",header:"programa"}),t(s(r),{field:"estado",style:{"justify-content":"center",display:"flex"},header:"Estado",width:"70px"},{body:n(({data:e})=>[l("div",se,[e.estado===1?(d(),p("div",te,[t(s(_),{severity:"info",value:"Activo"})])):v("",!0),e.estado===0?(d(),p("div",oe,[t(s(_),{style:{background:"#CDCDCD"},value:"Inactivo"})])):v("",!0)])]),_:1}),t(s(r),{field:"id_programa",header:"Acciones",width:"90px"},{body:n(({data:e})=>[l("div",ae,[t(s(f),{class:"",severity:"help",icon:"pi pi-eye","aria-label":"Submit",onClick:D=>a.editar(e),size:"small",style:{width:"25px",height:"25px"}},null,8,["onClick"])])]),_:1})]),_:1},8,["selection","value"])])])])):v("",!0),c.value!=null?(d(),p("div",le,[l("div",null,[l("div",ie,[l("div",ne,[t(s(f),{onClick:o[2]||(o[2]=e=>z()),label:"Descargar Acta PDF",icon:"pi pi-file-pdf",severity:"help",class:"mr-4"}),t(s(L),{layout:"vertical"}),t(s(f),{onClick:o[3]||(o[3]=e=>S()),label:"Guardar Notas",icon:"pi pi-save",disabled:Object.keys(i.value).length===0,class:"ml-4",severity:"success"},null,8,["disabled"])]),l("span",re,[de,t(s(F),{modelValue:h.value,"onUpdate:modelValue":o[4]||(o[4]=e=>h.value=e),style:{"padding-left":"40px",height:"40px"},placeholder:"Buscar"},null,8,["modelValue"])])])]),l("div",ce,[t(s(E),{value:V.value,class:A("p-datatable-sm mt-4"),selectionMode:"single",selection:k.value,"onUpdate:selection":o[5]||(o[5]=e=>k.value=e),editMode:"cell",onCellEditInit:B,tableStyle:"min-width: 50rem"},{default:n(()=>[t(s(r),{field:"codigo_est",header:"Código",sortable:""}),t(s(r),{header:"Nombre Completo",sortable:""},{body:n(({data:e})=>[$(m(e.nombres)+", "+m(e.paterno)+" "+m(e.materno),1)]),_:1}),t(s(r),{field:"semestre",header:"Ingreso",sortable:""}),t(s(r),{field:"ant",header:"Nota Admisión",sortable:""},{body:n(({data:e})=>[l("div",ue,m(e.ant||"-"),1)]),_:1}),t(s(r),{field:"nota",header:"Nota Final",sortable:""},{editor:n(({data:e})=>[t(s(G),{style:{width:"100px"},modelValue:i.value[e.id],"onUpdate:modelValue":D=>i.value[e.id]=D,inputId:"minmaxfraction",max:20,min:0,maxFractionDigits:2,autofocus:""},null,8,["modelValue","onUpdate:modelValue"])]),body:n(({data:e})=>[i.value[e.id]!==void 0?(d(),p("div",pe,m(Number(i.value[e.id]).toFixed(2)),1)):e.nota===null||e.nota===""||e.nota===0?(d(),p("div",me," - ")):(d(),p("div",ve,m(Number(e.nota).toFixed(2)),1))]),_:1}),t(s(r),{header:"Condición"},{body:n(({data:e})=>[l("div",fe,[i.value[e.id]!==void 0?(d(),j(s(_),{key:0,severity:i.value[e.id]>=10.5?"info":"danger",value:i.value[e.id]>=10.5?"Aprobado":"Desaprobado"},null,8,["severity","value"])):(d(),j(s(_),{key:1,severity:e.condicion?"info":"danger",value:e.condicion?"Aprobado":"Desaprobado"},null,8,["severity","value"]))])]),_:1})]),_:1},8,["value","selection"])])])):v("",!0)])]),_:1})],64))}};export{Ne as default};
