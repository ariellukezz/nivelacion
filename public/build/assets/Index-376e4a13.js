import{s as p,a as _}from"./index.esm-b6b36824.js";import{s as F}from"./dropdown.esm-7dc5e2ba.js";import{a as L,s as j}from"./TopMenu-5fc87428.js";import{A}from"./LayoutSuperadmi-584a8f9c.js";import{j as U,u as B,r,M as I,c as M,a as o,b as s,w as n,F as T,d as g,o as G,Z as q,e as l,n as Z,f as H,t as J}from"./app-9957fcc0.js";import{s as K}from"./datatable.esm-42a8ea18.js";import{s as v}from"./column.esm-434bfdc1.js";import{s as O}from"./confirmdialog.esm-4f219e05.js";import{s as P}from"./tag.esm-0a079832.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./ResponsiveNavLink-c81f6204.js";import"./inputnumber.esm-2a310672.js";const Q=l("div",{class:"text-center mb-4"},[l("h2",{class:"text-2xl font-bold text-gray-800"},"Gestión de Eventos")],-1),R={class:"flex flex-col gap-3"},W=l("label",null,"Nombre del Evento",-1),X=l("label",null,"Fecha",-1),Y=l("label",null,"Estado",-1),ee={class:"flex justify-end mt-3"},ae={class:"flex"},te={class:"mr-2"},ye={__name:"Index",setup(oe){const w=U(),f=B(),i=r(""),c=r(""),d=r("activo"),m=r(null),E=r([]),u=r(!1),$=r([{label:"Activo",value:"activo"},{label:"Inactivo",value:"inactivo"}]),V=a=>{const t={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(a).toLocaleDateString("es-ES",t)},y=async()=>{try{const a=await g.get("get-eventos");E.value=a.data}catch{b("Error al obtener eventos")}},C=async()=>{var a,t;try{const e=m.value?"actualizado":"creado";await g.post("guardar-evento",{id:m.value,nombre_evento:i.value,fecha:c.value,estado:d.value}),x(`Evento ${e} correctamente`),S(),u.value=!1,y()}catch(e){b(((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"Error al guardar evento")}},k=a=>{w.require({message:`¿Estás seguro de cerrar el evento "${a.nombre_evento}"?`,header:"Confirmación",icon:"pi pi-exclamation-triangle",acceptLabel:"Sí, cerrar",rejectLabel:"Cancelar",accept:()=>N(a),reject:()=>{f.add({severity:"info",summary:"Cancelado",detail:"No se cerró el evento",life:3e3})}})},N=async a=>{var t,e;try{await g.get("eliminar-evento/"+a.id),x("Evento cerrado correctamente"),y()}catch(h){const D=((e=(t=h.response)==null?void 0:t.data)==null?void 0:e.message)||"Error al cerrar evento";b(D)}},z=a=>{u.value=!0,m.value=a.id,i.value=a.nombre_evento,c.value=a.fecha.split("T")[0],d.value=a.estado},S=()=>{m.value=null,i.value="",c.value="",d.value="activo"},x=a=>{f.add({severity:"success",summary:"Éxito",detail:a,life:3e3})},b=a=>{f.add({severity:"error",summary:"Error",detail:a,life:5e3})};return I(()=>{y()}),(a,t)=>(G(),M(T,null,[o(s(q),{title:"Eventos"}),o(A,null,{default:n(()=>[Q,l("div",null,[o(s(p),{label:"Nuevo Evento",severity:"info",onClick:t[0]||(t[0]=e=>u.value=!0)}),o(s(L),{visible:u.value,"onUpdate:visible":t[5]||(t[5]=e=>u.value=e),modal:"",header:"Nuevo Evento",style:{width:"500px"}},{default:n(()=>[l("div",R,[l("div",null,[W,o(s(_),{type:"text",modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),class:"w-full"},null,8,["modelValue"])]),l("div",null,[X,o(s(_),{type:"date",modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=e=>c.value=e),class:"w-full"},null,8,["modelValue"])]),l("div",null,[Y,o(s(F),{modelValue:d.value,"onUpdate:modelValue":t[3]||(t[3]=e=>d.value=e),options:$.value,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","options"])]),l("div",ee,[o(s(p),{label:"Guardar",severity:"info",onClick:t[4]||(t[4]=e=>C())})])])]),_:1},8,["visible"]),o(s(O)),o(s(j)),o(s(K),{value:E.value,class:Z("p-datatable-sm"),paginator:"",rows:10,tableStyle:"min-width: 50rem",style:{"font-size":"0.8rem"}},{default:n(()=>[o(s(v),{field:"id",header:"ID"}),o(s(v),{field:"nombre_evento",header:"Nombre del Evento"}),o(s(v),{field:"fecha",header:"Fecha"},{body:n(({data:e})=>[H(J(V(e.fecha)),1)]),_:1}),o(s(v),{field:"estado",header:"Estado"},{body:n(({data:e})=>[o(s(P),{value:e.estado,severity:e.estado==="activo"?"success":"danger",rounded:!0,class:"capitalize"},null,8,["value","severity"])]),_:1}),o(s(v),{header:"Acciones",width:"120px"},{body:n(({data:e})=>[l("div",ae,[l("div",te,[o(s(p),{class:"secondary",icon:"pi pi-pencil","aria-label":"Editar",onClick:h=>z(e),size:"small",style:{width:"25px",height:"25px"}},null,8,["onClick"])]),o(s(p),{icon:"pi pi-trash",severity:"danger","aria-label":"Eliminar",onClick:h=>k(e),size:"small",style:{width:"25px",height:"25px"}},null,8,["onClick"])])]),_:1})]),_:1},8,["value"])])]),_:1})],64))}};export{ye as default};
