import{s as p,a as _}from"./index.esm-b50760ad.js";import{s as F}from"./dropdown.esm-b8162aa9.js";import{b as L,s as A,a as U}from"./TopMenu-edcbe2b9.js";import{A as j}from"./LayoutSuperadmi-2cb9848c.js";import{k as B,u as I,r,o as T,c as G,b as o,d as s,w as n,F as M,a as g,e as q,Z,f as l,n as H,g as J,t as K}from"./app-df00ec4e.js";import{s as O}from"./datatable.esm-71078f41.js";import{s as v}from"./column.esm-434bfdc1.js";import{s as P}from"./confirmdialog.esm-d6ce107e.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./ResponsiveNavLink-fc04ebc9.js";import"./inputnumber.esm-fe2002eb.js";const Q=l("div",{class:"text-center mb-4"},[l("h2",{class:"text-2xl font-bold text-gray-800"},"Gestión de Eventos")],-1),R={class:"flex flex-col gap-3"},W=l("label",null,"Nombre del Evento",-1),X=l("label",null,"Fecha",-1),Y=l("label",null,"Estado",-1),ee={class:"flex justify-end mt-3"},ae={class:"flex"},te={class:"mr-2"},fe={__name:"Index",setup(oe){const w=B(),f=I(),i=r(""),c=r(""),d=r("activo"),m=r(null),E=r([]),u=r(!1),$=r([{label:"Activo",value:"activo"},{label:"Inactivo",value:"inactivo"}]),V=a=>{const t={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(a).toLocaleDateString("es-ES",t)},b=async()=>{try{const a=await g.get("get-eventos");E.value=a.data}catch{y("Error al obtener eventos")}},C=async()=>{var a,t;try{const e=m.value?"actualizado":"creado";await g.post("guardar-evento",{id:m.value,nombre_evento:i.value,fecha:c.value,estado:d.value}),x(`Evento ${e} correctamente`),S(),u.value=!1,b()}catch(e){y(((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"Error al guardar evento")}},k=a=>{w.require({message:`¿Estás seguro de cerrar el evento "${a.nombre_evento}"?`,header:"Confirmación",icon:"pi pi-exclamation-triangle",acceptLabel:"Sí, cerrar",rejectLabel:"Cancelar",accept:()=>N(a),reject:()=>{f.add({severity:"info",summary:"Cancelado",detail:"No se cerró el evento",life:3e3})}})},N=async a=>{var t,e;try{await g.get("eliminar-evento/"+a.id),x("Evento cerrado correctamente"),b()}catch(h){const D=((e=(t=h.response)==null?void 0:t.data)==null?void 0:e.message)||"Error al cerrar evento";y(D)}},z=a=>{u.value=!0,m.value=a.id,i.value=a.nombre_evento,c.value=a.fecha.split("T")[0],d.value=a.estado},S=()=>{m.value=null,i.value="",c.value="",d.value="activo"},x=a=>{f.add({severity:"success",summary:"Éxito",detail:a,life:3e3})},y=a=>{f.add({severity:"error",summary:"Error",detail:a,life:5e3})};return T(()=>{b()}),(a,t)=>(q(),G(M,null,[o(s(Z),{title:"Eventos"}),o(j,null,{default:n(()=>[Q,l("div",null,[o(s(p),{label:"Nuevo Evento",severity:"info",onClick:t[0]||(t[0]=e=>u.value=!0)}),o(s(L),{visible:u.value,"onUpdate:visible":t[5]||(t[5]=e=>u.value=e),modal:"",header:"Nuevo Evento",style:{width:"500px"}},{default:n(()=>[l("div",R,[l("div",null,[W,o(s(_),{type:"text",modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),class:"w-full"},null,8,["modelValue"])]),l("div",null,[X,o(s(_),{type:"date",modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=e=>c.value=e),class:"w-full"},null,8,["modelValue"])]),l("div",null,[Y,o(s(F),{modelValue:d.value,"onUpdate:modelValue":t[3]||(t[3]=e=>d.value=e),options:$.value,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","options"])]),l("div",ee,[o(s(p),{label:"Guardar",severity:"info",onClick:t[4]||(t[4]=e=>C())})])])]),_:1},8,["visible"]),o(s(P)),o(s(A)),o(s(O),{value:E.value,class:H("p-datatable-sm"),paginator:"",rows:10,tableStyle:"min-width: 50rem",style:{"font-size":"0.8rem"}},{default:n(()=>[o(s(v),{field:"id",header:"ID"}),o(s(v),{field:"nombre_evento",header:"Nombre del Evento"}),o(s(v),{field:"fecha",header:"Fecha"},{body:n(({data:e})=>[J(K(V(e.fecha)),1)]),_:1}),o(s(v),{field:"estado",header:"Estado"},{body:n(({data:e})=>[o(s(U),{value:e.estado,severity:e.estado==="activo"?"success":"danger",rounded:!0,class:"capitalize"},null,8,["value","severity"])]),_:1}),o(s(v),{header:"Acciones",width:"120px"},{body:n(({data:e})=>[l("div",ae,[l("div",te,[o(s(p),{class:"secondary",icon:"pi pi-pencil","aria-label":"Editar",onClick:h=>z(e),size:"small",style:{width:"25px",height:"25px"}},null,8,["onClick"])]),o(s(p),{icon:"pi pi-trash",severity:"danger","aria-label":"Eliminar",onClick:h=>k(e),size:"small",style:{width:"25px",height:"25px"}},null,8,["onClick"])])]),_:1})]),_:1},8,["value"])])]),_:1})],64))}};export{fe as default};
