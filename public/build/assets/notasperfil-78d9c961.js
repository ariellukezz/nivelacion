import{r as l,l as S,w as $,d as D,o as d,e,x as f,a5 as L,c as r,k as b,F as y,a6 as N,a as A,b as I,t as a}from"./app-04670fa7.js";import{A as O}from"./LayoutSuperadmi-9bd98158.js";import{X as p}from"./xlsx-5988c4fc.js";import{a as P}from"./TopMenu-f7298994.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./ResponsiveNavLink-5136f6d3.js";const V={class:"p-4",style:{background:"white"}},j={class:"flex justify-between mb-2"},q=e("label",{for:"programa"},"Programa de Estudio: ",-1),z=e("option",{value:""},"Todos",-1),F=["value"],M=e("label",{for:"busqueda"},"Buscar por Nombre o DNI: ",-1),R={style:{"border-radius":"4px",width:"100%",overflow:"hidden"}},T=e("thead",{style:{height:"30px",color:"white","background-color":"var(--primary-color)",padding:"0px 10px"}},[e("tr",{style:{"font-size":".9rem"}},[e("th",{style:{border:"1px solid #d9d9d9"}},"DNI"),e("th",{style:{border:"1px solid #d9d9d9"}},"APELLIDOS Y NOMBRES"),e("th",{style:{border:"1px solid #d9d9d9"}},"PROGRAMA DE ESTUDIO"),e("th",{style:{border:"1px solid #d9d9d9"}},"INGRESO"),e("th",{style:{border:"1px solid #d9d9d9"}},"C1"),e("th",{style:{border:"1px solid #d9d9d9"}},"C2"),e("th",{style:{border:"1px solid #d9d9d9"}},"C3"),e("th",{style:{border:"1px solid #d9d9d9"}},"C4"),e("th",{style:{border:"1px solid #d9d9d9"}},"C5"),e("th",{style:{border:"1px solid #d9d9d9"}},"C6"),e("th",{style:{border:"1px solid #d9d9d9"}},"C7"),e("th",{style:{border:"1px solid #d9d9d9"}},"C8"),e("th",{style:{border:"1px solid #d9d9d9"}},"C9"),e("th",{style:{border:"1px solid #d9d9d9"}},"C10"),e("th",{style:{border:"1px solid #d9d9d9"}},"C11")])],-1),U={style:{border:"1px solid #d9d9d9","font-weight":".8rem","text-align":"center"}},X={class:"pl-1 pr-1"},G={style:{border:"1px solid #d9d9d9","font-weight":".7rem"}},Y={class:"pl-1 pr-1"},H={style:{border:"1px solid #d9d9d9","font-weight":".8rem","text-align":"center"}},J={class:"pl-1 pr-1"},K={style:{border:"1px solid #d9d9d9","font-weight":".8rem","text-align":"center"}},Q={class:"pl-1 pr-1"},W={key:0,style:{"text-align":"center"}},Z={key:0},ee={key:1},te=e("span",{style:{"font-size":".9rem"}},null,-1),oe=[te],se={key:1,style:{"text-align":"center"}},ce={__name:"notasperfil",setup(de){function u(o,s){for(var t=0;t<o.length;t++)if(o[t].competencia===s)return t;return null}const m=l(1),h=l([]),_=l([]),v=l([]),c=l(""),i=l(""),g=l([]),w=async()=>{let o=await D.get("notasperf?page="+m.value,{term:""});h.value=o.data.datos,C(),x()},C=()=>{const o=new Set;h.value.forEach(s=>{o.add(s.programa)}),v.value=Array.from(o)},x=()=>{_.value=h.value.filter(o=>{const s=c.value===""||o.programa===c.value,t=i.value===""||o.dni.includes(i.value)||`${o.paterno} ${o.materno} ${o.nombre}`.toLowerCase().includes(i.value.toLowerCase());return s&&t}),k()},k=()=>{g.value=_.value.map(o=>{const s={dni:o.dni,programa:o.programa,semestre:o.semestre,nombreCompleto:`${o.paterno} ${o.materno},  ${o.nombre}`};for(let t=1;t<=11;t++){const n=u(o.notas,t);n!==null?s[`C${t}`]=o.notas[n].nota:s[`C${t}`]="--"}return s})},E=()=>{const o=p.utils.json_to_sheet(g.value),s=p.utils.book_new();p.utils.book_append_sheet(s,o,"Estudiantes"),p.writeFile(s,"estudiantes.xlsx")};return w(),(o,s)=>(d(),S(O,null,{default:$(()=>[e("div",V,[e("div",j,[e("div",null,[q,f(e("select",{id:"programa","onUpdate:modelValue":s[0]||(s[0]=t=>c.value=t),onChange:x},[z,(d(!0),r(y,null,b(v.value,t=>(d(),r("option",{key:t,value:t},a(t),9,F))),128))],544),[[L,c.value]])]),e("div",null,[M,f(e("input",{id:"busqueda","onUpdate:modelValue":s[1]||(s[1]=t=>i.value=t),onInput:x,type:"text",placeholder:"Buscar..."},null,544),[[N,i.value]])]),A(I(P),{label:"Exportar excel",onClick:E,size:"small",style:{height:"40px"}})]),e("table",R,[T,e("tbody",null,[(d(!0),r(y,null,b(_.value,t=>(d(),r("tr",{key:t.id,style:{"font-size":".9rem"}},[e("td",U,[e("div",X,a(t.dni),1)]),e("td",G,[e("div",Y,a(t.paterno)+" "+a(t.materno)+", "+a(t.nombre),1)]),e("td",H,[e("div",J,a(t.programa),1)]),e("td",K,[e("div",Q,a(t.semestre),1)]),(d(),r(y,null,b(11,(n,B)=>e("td",{key:B,style:{border:"1px solid #d9d9d9","min-width":"40px"}},[u(t.notas,n)!==null?(d(),r("div",W,[t.notas[u(t.notas,n)]?(d(),r("div",Z,a(t.notas[u(t.notas,n)].nota),1)):(d(),r("div",ee,oe))])):(d(),r("div",se," - - "))])),64))]))),128))])])])]),_:1}))}};export{ce as default};
