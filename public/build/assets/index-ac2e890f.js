import{A as m}from"./AuthenticatedLayout-d0f06eb4.js";import{r as p,k as v,w as C,o as d,d as t,a as k,b as w,c as r,j as _,F as u,t as l}from"./app-28a65f8f.js";import{X as i}from"./xlsx-6a791824.js";import{a as E}from"./TopMenu-a7cce80b.js";import"./_plugin-vue_export-helper-c27b6911.js";const j={class:"p-4",style:{background:"white"}},B={class:"flex justify-end mb-2"},$={style:{"border-radius":"4px",width:"100%",overflow:"hidden"}},z=t("thead",{style:{height:"30px",color:"white","background-color":"var(--primary-color)",padding:"0px 10px"}},[t("tr",{style:{"font-size":".9rem"}},[t("th",{style:{border:"1px solid #d9d9d9"}},"DNI"),t("th",{style:{border:"1px solid #d9d9d9"}},"NOMBRES"),t("th",{style:{border:"1px solid #d9d9d9"}},"PROGRAMA"),t("th",{style:{border:"1px solid #d9d9d9"}},"C1"),t("th",{style:{border:"1px solid #d9d9d9"}},"C2"),t("th",{style:{border:"1px solid #d9d9d9"}},"C3"),t("th",{style:{border:"1px solid #d9d9d9"}},"C4"),t("th",{style:{border:"1px solid #d9d9d9"}},"C5"),t("th",{style:{border:"1px solid #d9d9d9"}},"C6"),t("th",{style:{border:"1px solid #d9d9d9"}},"C7"),t("th",{style:{border:"1px solid #d9d9d9"}},"C8"),t("th",{style:{border:"1px solid #d9d9d9"}},"C9"),t("th",{style:{border:"1px solid #d9d9d9"}},"C10"),t("th",{style:{border:"1px solid #d9d9d9"}},"C11")])],-1),A={style:{border:"1px solid #d9d9d9","font-weight":".8rem","text-align":"center"}},N={class:"pl-1 pr-1"},F={style:{border:"1px solid #d9d9d9","font-weight":".7rem"}},L={class:"pl-1 pr-1"},O={style:{border:"1px solid #d9d9d9","font-weight":".8rem","text-align":"center"}},R={class:"pl-1 pr-1"},S={key:0,style:{"text-align":"center"}},V={key:0},X={key:1},D=t("span",{style:{"font-size":".9rem"}},null,-1),M=[D],G={key:1,style:{"text-align":"center"}},Q={__name:"index",setup(I){function a(s,o){for(var e=0;e<s.length;e++)if(s[e].competencia===o)return e;return null}const x=p(1),c=p([]),y=async()=>{let s=await axios.get("prueba2?page="+x.value,{term:""});c.value=s.data.datos,b()},h=p([]),b=()=>{h.value=c.value.map(s=>{const o={dni:s.dni,programa:s.programa,nombreCompleto:`${s.nombre} ${s.paterno} ${s.materno}`};for(let e=1;e<=11;e++){const n=a(s.notas,e);n!==null?o[`C${e}`]=s.notas[n].nota:o[`C${e}`]="--"}return o})},f=()=>{const s=i.utils.json_to_sheet(h.value),o=i.utils.book_new();i.utils.book_append_sheet(o,s,"Estudiantes"),i.writeFile(o,"estudiantes.xlsx")};return y(),(s,o)=>(d(),v(m,null,{default:C(()=>[t("div",j,[t("div",B,[k(w(E),{label:"Exportar excel",onClick:f,size:"small",style:{height:"40px"}})]),t("table",$,[z,t("tbody",null,[(d(!0),r(u,null,_(c.value,e=>(d(),r("tr",{key:e.id,style:{"font-size":".9rem"}},[t("td",A,[t("div",N,l(e.dni),1)]),t("td",F,[t("div",L,l(e.nombre)+" "+l(e.paterno)+" "+l(e.materno),1)]),t("td",O,[t("div",R,l(e.programa),1)]),(d(),r(u,null,_(11,(n,g)=>t("td",{key:g,style:{border:"1px solid #d9d9d9","min-width":"40px"}},[a(e.notas,n)!==null?(d(),r("div",S,[e.notas[a(e.notas,n)]?(d(),r("div",V,l(e.notas[a(e.notas,n)].nota),1)):(d(),r("div",X,M))])):(d(),r("div",G," - - "))])),64))]))),128))])])])]),_:1}))}};export{Q as default};
