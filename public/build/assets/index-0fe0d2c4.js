import{A as F}from"./AuthenticatedLayout-12214e9e.js";import{u as T,k as B,r as p,l as C,c as y,b as o,d as t,w as d,F as q,a as b,e as x,Z as L,f as e,g as P,n as G,t as E,i as $}from"./app-df00ec4e.js";import{s as v,a as r}from"./index.esm-b50760ad.js";import{s as H}from"./datatable.esm-71078f41.js";import{s as m}from"./column.esm-434bfdc1.js";import{s as Q,a as k,b as Z}from"./TopMenu-edcbe2b9.js";import{s as J}from"./inputswitch.esm-9fffc8a1.js";import{s as K}from"./confirmpopup.esm-ade2d6c6.js";import{s as N}from"./calendar.esm-f2e9caa2.js";import{s as M}from"./message.esm-491e6fcd.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./dropdown.esm-b8162aa9.js";import"./inputnumber.esm-fe2002eb.js";import"./index.esm-eeb2d688.js";const R=e("div",{class:"text-center mb-4"},[e("h2",{class:"text-2xl font-bold text-gray-800"},"Datos del encargado del Sistema")],-1),W={class:"bg-white shadow-xs p-4",style:{height:"calc(100vh - 110px)","font-family":"Arial, Helvetica, sans-serif"}},X={class:"card"},Y={class:"flex",style:{"justify-content":"space-between"}},ee={class:"p-input-icon-left"},ae=e("i",{class:"pi pi-search"},null,-1),le={class:"card"},se={class:"flex",style:{"justify-content":"flex-start"}},oe={class:"flex",style:{"justify-content":"center"}},te={key:0},ie={key:1},ne={class:"flex"},de={class:"mr-2"},re={class:"flex mt-0 mb-3 align-items-center",style:{"justify-content":"flex-end"}},ce={class:"mr-3"},ue=e("label",null,"Estado",-1),me={class:"flex",style:{width:"100%","justify-content":"space-between"}},pe={class:"mb-2",style:{width:"48%"}},ve=e("div",null,[e("label",null,"DNI")],-1),_e={class:"mb-2",style:{width:"48%"}},he=e("div",null,[e("label",null,"Nombres")],-1),ge={class:"flex",style:{width:"100%","justify-content":"space-between"}},fe={class:"mb-2",style:{width:"48%"}},ye=e("div",null,[e("label",null,"Apellidos")],-1),be={class:"mb-2",style:{width:"48%"}},xe=e("div",null,[e("label",null,"Correo")],-1),we={class:"flex",style:{width:"100%","justify-content":"space-between"}},Ve={class:"mb-2",style:{width:"48%"}},Ce=e("div",null,[e("label",null,"Celular (Oblogatorio)")],-1),Ee={class:"mb-2",style:{width:"48%"}},$e=e("div",null,[e("label",null,"Cargo")],-1),ke={class:"flex",style:{width:"100%","justify-content":"space-between"}},Ne={class:"mb-2",style:{width:"48%"}},je=e("div",null,[e("label",null,"Fecha de Designación (Opcional)")],-1),Ue={class:"mb-2",style:{width:"48%"}},De=e("div",null,[e("label",null,"Fecha de Fin de Designación (Opcional)")],-1),Ie={class:"mb-2",style:{width:"100%"}},Oe=e("div",null,[e("label",null,"Observaciones (Que periodo estara Encargo, Ejemplo : 2025-II y 2026-I u Otro sea necesario)")],-1),Se={class:"flex",style:{"justify-content":"flex-end"}},Re={__name:"index",setup(ze){const j=T(),U=B(),w=p([]),c=p(!1),_=p(""),h=p(!1),s=p({id_encargado:null,dni:"",nombres:"",apellidos:"",correo:"",num_celular:"",cargo:"",fecha_designacion:null,fecha_fin_designacion:null,observaciones:"",estado:!0,usuario_id:null}),g=async()=>{var i,l;try{const a=await b.post("/get-encargados",{term:_.value});w.value=a.data}catch(a){const n=((l=(i=a.response)==null?void 0:i.data)==null?void 0:l.message)||"No se pudieron cargar los encargados";u("error","Error",n)}},D=async()=>{var i,l,a;try{const n=await b.post("/save-encargado",{id_encargado:s.value.id_encargado,dni:s.value.dni,nombres:s.value.nombres,apellidos:s.value.apellidos,correo:s.value.correo,num_celular:s.value.num_celular||null,cargo:s.value.cargo,fecha_designacion:s.value.fecha_designacion?s.value.fecha_designacion.toISOString().substring(0,10):null,fecha_fin_designacion:s.value.fecha_fin_designacion?s.value.fecha_fin_designacion.toISOString().substring(0,10):null,observaciones:s.value.observaciones||null,estado:s.value.estado?1:0,usuario_id:s.value.usuario_id||null});u("success","Éxito",n.data.message||"Encargado guardado con éxito"),g(),c.value=!1,V()}catch(n){const f=((l=(i=n.response)==null?void 0:i.data)==null?void 0:l.message)||"No se pudo guardar el encargado";if(((a=n.response)==null?void 0:a.status)===422){const z=n.response.data.errors,A=Object.values(z)[0][0];u("error","Error de validación",A)}else u("error","Error",f)}},I=async i=>{var l,a;try{const n=await b.delete(`/delete-encargado/${i}`);u("success","Éxito",n.data.message||"Encargado eliminado con éxito"),g()}catch(n){const f=((a=(l=n.response)==null?void 0:l.data)==null?void 0:a.message)||"No se pudo eliminar el encargado";u("error","Error",f)}},O=i=>{c.value=!0,h.value=!0,s.value={id_encargado:i.id_encargado,dni:i.dni,nombres:i.nombres,apellidos:i.apellidos,correo:i.correo,num_celular:i.num_celular||"",cargo:i.cargo,fecha_designacion:i.fecha_designacion?new Date(i.fecha_designacion):null,fecha_fin_designacion:i.fecha_fin_designacion?new Date(i.fecha_fin_designacion):null,observaciones:i.observaciones||"",estado:i.estado===1,usuario_id:i.usuario_id||null}},V=()=>{s.value={id_encargado:null,dni:"",nombres:"",apellidos:"",correo:"",num_celular:"",cargo:"",fecha_designacion:null,fecha_fin_designacion:null,observaciones:"",estado:!0,usuario_id:null},h.value=!1},S=(i,l)=>{U.require({target:i.currentTarget,message:`¿Estás seguro de eliminar al encargado ${l.nombres} ${l.apellidos}?`,icon:"pi pi-info-circle",acceptClass:"p-button-danger",accept:()=>{I(l.id_encargado)},reject:()=>{u("error","Cancelado",`Se ha cancelado la eliminación del encargado ${l.nombres} ${l.apellidos}`)}})},u=(i,l,a)=>{j.add({severity:i,summary:l,detail:a,life:3e3})};return C(c,i=>{!i&&h.value&&V()}),C(_,()=>{g()}),g(),(i,l)=>(x(),y(q,null,[o(t(L),{title:"Encargados del Sistema"}),o(F,null,{default:d(()=>[R,e("div",W,[e("div",null,[e("div",X,[o(t(M),{severity:"warn",sticky:""},{default:d(()=>[P(" La persona registrada será responsable y encargada del proceso de nivelación en el sistema. Al finalizar su cargo, podrá ser cambiada al estado INACTIVO. Complete todos los datos requeridos para asegurar una comunicación constante durante el proceso ")]),_:1})]),e("div",Y,[o(t(v),{label:"Encargado Nuevo",onClick:l[0]||(l[0]=a=>c.value=!0),size:"small",style:{height:"40px"}}),e("span",ee,[ae,o(t(r),{modelValue:_.value,"onUpdate:modelValue":l[1]||(l[1]=a=>_.value=a),style:{"padding-left":"40px",height:"40px"},placeholder:"Buscar"},null,8,["modelValue"])])])]),o(t(Q)),o(t(K)),e("div",null,[e("div",le,[o(t(H),{value:w.value,class:G("p-datatable-sm"),paginator:"",rows:10,rowsPerPageOptions:[10,20,50],tableStyle:"min-width: 50rem",style:{"font-size":".9rem"}},{default:d(()=>[o(t(m),{field:"dni",header:"DNI"}),o(t(m),{field:"nombres",header:"Nombres"},{body:d(({data:a})=>[e("div",se,[e("div",null,E(a.nombres)+" "+E(a.apellidos),1)])]),_:1}),o(t(m),{field:"correo",header:"Correo"}),o(t(m),{field:"num_celular",header:"Celular"}),o(t(m),{field:"cargo",header:"Cargo"}),o(t(m),{field:"estado",header:"Estado",style:{"justify-content":"center",display:"flex"},width:"70px"},{body:d(({data:a})=>[e("div",oe,[a.estado===1?(x(),y("div",te,[o(t(k),{severity:"info",value:"Activo"})])):$("",!0),a.estado===0?(x(),y("div",ie,[o(t(k),{style:{background:"#CDCDCD"},value:"Inactivo"})])):$("",!0)])]),_:1}),o(t(m),{field:"id_encargado",header:"Acciones",width:"90px"},{body:d(({data:a})=>[e("div",ne,[e("div",de,[o(t(v),{class:"secondary",icon:"pi pi-pencil","aria-label":"Editar",onClick:n=>O(a),size:"small",style:{width:"25px",height:"25px"}},null,8,["onClick"])]),o(t(v),{icon:"pi pi-trash",severity:"danger","aria-label":"Eliminar",onClick:n=>S(n,a),size:"small",style:{width:"25px",height:"25px"}},null,8,["onClick"])])]),_:1})]),_:1},8,["value"])])]),o(t(Z),{visible:c.value,"onUpdate:visible":l[13]||(l[13]=a=>c.value=a),header:h.value?"Editar Encargado":"Encargado Nuevo",style:{width:"60vw",height:"600px"}},{footer:d(()=>[e("div",Se,[e("div",null,[o(t(v),{label:"Cancelar",outlined:"",onClick:l[12]||(l[12]=a=>c.value=!1),size:"small"})]),o(t(v),{label:"Guardar",onClick:D,size:"small"})])]),default:d(()=>[e("div",null,[e("div",re,[e("div",ce,[ue,e("div",null,[o(t(J),{modelValue:s.value.estado,"onUpdate:modelValue":l[2]||(l[2]=a=>s.value.estado=a)},null,8,["modelValue"])])])]),e("div",me,[e("div",pe,[ve,o(t(r),{style:{width:"100%",height:"40px"},type:"text",modelValue:s.value.dni,"onUpdate:modelValue":l[3]||(l[3]=a=>s.value.dni=a)},null,8,["modelValue"])]),e("div",_e,[he,o(t(r),{style:{width:"100%",height:"40px"},type:"text",modelValue:s.value.nombres,"onUpdate:modelValue":l[4]||(l[4]=a=>s.value.nombres=a)},null,8,["modelValue"])])]),e("div",ge,[e("div",fe,[ye,o(t(r),{style:{width:"100%",height:"40px"},type:"text",modelValue:s.value.apellidos,"onUpdate:modelValue":l[5]||(l[5]=a=>s.value.apellidos=a)},null,8,["modelValue"])]),e("div",be,[xe,o(t(r),{style:{width:"100%",height:"40px"},type:"email",modelValue:s.value.correo,"onUpdate:modelValue":l[6]||(l[6]=a=>s.value.correo=a)},null,8,["modelValue"])])]),e("div",we,[e("div",Ve,[Ce,o(t(r),{style:{width:"100%",height:"40px"},type:"text",modelValue:s.value.num_celular,"onUpdate:modelValue":l[7]||(l[7]=a=>s.value.num_celular=a)},null,8,["modelValue"])]),e("div",Ee,[$e,o(t(r),{style:{width:"100%",height:"40px"},type:"text",modelValue:s.value.cargo,"onUpdate:modelValue":l[8]||(l[8]=a=>s.value.cargo=a)},null,8,["modelValue"])])]),e("div",ke,[e("div",Ne,[je,o(t(N),{style:{width:"100%",height:"40px"},dateFormat:"yy-mm-dd",modelValue:s.value.fecha_designacion,"onUpdate:modelValue":l[9]||(l[9]=a=>s.value.fecha_designacion=a)},null,8,["modelValue"])]),e("div",Ue,[De,o(t(N),{style:{width:"100%",height:"40px"},dateFormat:"yy-mm-dd",modelValue:s.value.fecha_fin_designacion,"onUpdate:modelValue":l[10]||(l[10]=a=>s.value.fecha_fin_designacion=a)},null,8,["modelValue"])])]),e("div",Ie,[Oe,o(t(r),{style:{width:"100%",height:"40px"},type:"text",modelValue:s.value.observaciones,"onUpdate:modelValue":l[11]||(l[11]=a=>s.value.observaciones=a)},null,8,["modelValue"])])])]),_:1},8,["visible","header"])])]),_:1})],64))}};export{Re as default};
